{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":87694,"status":"ok","timestamp":1745902016635,"user":{"displayName":"Seongyun Lee","userId":"17227422253819502349"},"user_tz":-540},"id":"XV0VDOMl6qbc","outputId":"b704c5ae-4ebf-4a98-ae4b-c8eccbfbc319"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')\n"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":9,"status":"ok","timestamp":1745902016639,"user":{"displayName":"Seongyun Lee","userId":"17227422253819502349"},"user_tz":-540},"id":"WJCVH_Ni6q5p"},"outputs":[],"source":["# ë“œë¼ì´ë¸Œ ë‚´ì˜ ë°ì´í„°ê°€ ìˆëŠ” í´ë” ê²½ë¡œ ì„¤ì •\n","base_path = '/content/drive/MyDrive/062.á„‡á…¡á†«á„…á…§á„ƒá…©á†¼á„†á…®á†¯ á„Œá…µá†¯á„‡á…§á†¼ á„Œá…µá†«á„ƒá…¡á†«á„‹á…³á†¯ á„‹á…±á„’á…¡á†« á„‹á…§á†¼á„‰á…¡á†¼ á„ƒá…¦á„‹á…µá„á…¥ (á„€á…³á†«á„€á…©á†¯á„€á…§á†¨á„€á…¨)'\n"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":614,"status":"ok","timestamp":1745902017246,"user":{"displayName":"Seongyun Lee","userId":"17227422253819502349"},"user_tz":-540},"id":"dF99AqPY68yQ","outputId":"3233a952-bbb0-46e2-a85c-96757dfdbbc4"},"outputs":[{"output_type":"stream","name":"stdout","text":["['Colab Notebooks', 'Untitled0.ipynb', 'Untitled (1)', 'Untitled1.ipynb', 'Untitled2.ipynb', 'Untitled3.ipynb', 'OTg6QzA_activities.csv', 'chapter 8 á„‰á…¡á„…á…¨1 á„ƒá…¦á„‹á…µá„á…¥á„…á…³á†¯ á„‰á…µá„€á…¡á†¨á„’á…ªá„’á…¢ á„‡á…©á„€á…µ.ipynb', 'numpy', 'git test', 'pandas', 'data', 'lsy', 'á„†á…¦á„†á…©á„Œá…¡á†¼', 'numpy1', 'from_scratch', 'git_test', 'practice', 'archive.ics.uci.edu', 'á„Œá…¡á„…á…­', 'á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º', 'Untitled4.ipynb', 'Untitled5.ipynb', 'Untitled6.ipynb', 'Untitled7.ipynb', 'Untitled8.ipynb', '4.py', 'baseline_submission.csv', 'á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-03-22 160409.png', '1.py', 'Untitled9.ipynb', '250325_á„‹á…µá„‰á…¥á†¼á„‹á…²á†«_keggl-titanic.ipynb', '.ipynb', '1 (6).ipynb', '1 (5).ipynb', '1 (4).ipynb', '1 (3).ipynb', '1 (2).ipynb', '1 (1).ipynb', '1.ipynb', 'bike_250328_á„‹á…µá„‰á…¥á†¼á„‹á…²á†«.ipynb', 'Untitled10.ipynb', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥', 'á„Œá…¡á„…á…­ á„†á…µá†¾ á„†á…¦á„†á…©á„Œá…¡á†¼', '250326', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (4)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (3)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (5)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (2)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (6)', '250401', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (7)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (1)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (8)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (9)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (10)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (11)', 'á„á…±á„Œá…³ (2).zip', 'á„á…±á„Œá…³ (1).zip', 'á„á…±á„Œá…³.zip', 'DL1-practice', 'á„‰á…®á„‹á…¥á†¸ á„ƒá…¡á„‹á…®á†«á„…á…©á„ƒá…³á„’á…¡á†« á„‘á…¡á„‹á…µá†¯', 'á„‰á…®á„‹á…¥á†¸ á„Œá…¡á„…á…­ á„†á…µá†¾ á„‰á…µá†¯á„‰á…³á†¸', 'á„á…±á„Œá…³ á„ƒá…¡á†¸', 'á„á…±á„Œá…³', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (13)', 'á„‰á…¢ á„‘á…©á†¯á„ƒá…¥ (12)', 'archive', 'Untitled11.ipynb', 'Untitled12.ipynb', 'á„‹á…µá„‰á…¥á†¼á„‹á…²á†«_artist_cls_keras_quiz.ipynb', 'artist_cls_keras_quiz.ipynb', 'artist_prediction.csv', '250418', '250418.zip', 'Untitled13.ipynb', 'open(á„ƒá…©á†¯).zip', 'extracted', 'clustering_results.csv', 'rock_classification_model_clustered_resnet50.pth', 'submission6.csv', 'Untitled14.ipynb', 'Untitled15.ipynb', 'Untitled16.ipynb', '062.á„‡á…¡á†«á„…á…§á„ƒá…©á†¼á„†á…®á†¯ á„Œá…µá†¯á„‡á…§á†¼ á„Œá…µá†«á„ƒá…¡á†«á„‹á…³á†¯ á„‹á…±á„’á…¡á†« á„‹á…§á†¼á„‰á…¡á†¼ á„ƒá…¦á„‹á…µá„á…¥ (á„€á…³á†«á„€á…©á†¯á„€á…§á†¨á„€á…¨)', '52.á„€á…®á†« á„€á…§á†¼á„€á…¨ á„Œá…¡á†¨á„Œá…¥á†« á„’á…ªá†«á„€á…§á†¼ á„’á…¡á†¸á„‰á…¥á†¼á„ƒá…¦á„‹á…µá„á…¥', 'Untitled17.ipynb', 'dataset', 'Untitled', '52.á„€á…®á†« á„€á…§á†¼á„€á…¨ á„Œá…¡á†¨á„Œá…¥á†« á„’á…ªá†«á„€á…§á†¼ á„’á…¡á†¸á„‰á…¥á†¼á„ƒá…¦á„‹á…µá„á…¥ (1)', '52.á„€á…®á†« á„€á…§á†¼á„€á…¨ á„Œá…¡á†¨á„Œá…¥á†« á„’á…ªá†«á„€á…§á†¼ á„’á…¡á†¸á„‰á…¥á†¼á„ƒá…¦á„‹á…µá„á…¥.zip', 'Untitled18.ipynb', '062.á„‡á…¡á†«á„…á…§á„ƒá…©á†¼á„†á…®á†¯ á„Œá…µá†¯á„‡á…§á†¼ á„Œá…µá†«á„ƒá…¡á†«á„‹á…³á†¯ á„‹á…±á„’á…¡á†« á„‹á…§á†¼á„‰á…¡á†¼ á„ƒá…¦á„‹á…µá„á…¥ (á„€á…³á†«á„€á…©á†¯á„€á…§á†¨á„€á…¨) YOLO á„‰á…¡á„‹á…­á†¼ .ipynb']\n"]}],"source":["# ë“œë¼ì´ë¸Œ ë‚´ ê²½ë¡œ íƒìƒ‰\n","import os\n","print(os.listdir('/content/drive/MyDrive/'))\n"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":275,"status":"ok","timestamp":1745902017522,"user":{"displayName":"Seongyun Lee","userId":"17227422253819502349"},"user_tz":-540},"id":"9mu5ouVW7Gf-","outputId":"243b8ce7-9695-4c20-a6fa-f23696564784"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["['01.á„ƒá…¦á„‹á…µá„á…¥', 'train']"]},"metadata":{},"execution_count":4}],"source":["# ë“œë¼ì´ë¸Œ ë‚´ ì •í™•í•œ ê²½ë¡œ ì¶œë ¥\n","base_path = '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)'\n","os.listdir(base_path)  # ì—¬ê¸°ì„œ í´ë”ê°€ ì •í™•íˆ ìˆëŠ”ì§€ í™•ì¸\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LZQ12_tL-lyU","outputId":"80c4daea-c292-49c6-a9e4-8dbfe75631e5"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["# 1. ë“œë¼ì´ë¸Œ ë§ˆìš´íŠ¸\n","from google.colab import drive\n","drive.mount('/content/drive')\n","\n","# 2. í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ import\n","import zipfile\n","import os\n","\n","# 3. ì••ì¶• í•´ì œ í•¨ìˆ˜\n","def unzip_file(zip_path, extract_to):\n","    with zipfile.ZipFile(zip_path, 'r') as zip_ref:\n","        zip_ref.extractall(extract_to)\n","    print(f\"âœ… ì••ì¶• í•´ì œ ì™„ë£Œ: {zip_path}\")\n","\n","# 4. ê²½ë¡œ ì„¤ì •\n","base_path = '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)'\n","\n","# Training ë¼ë²¨ë§ ë°ì´í„° ê²½ë¡œ\n","train_label_folder = os.path.join(base_path, '01.ë°ì´í„°/Training/ë¼ë²¨ë§ë°ì´í„°')\n","train_label_extract_folder = os.path.join(base_path, '01.ë°ì´í„°/Training/ë¼ë²¨ë§ë°ì´í„°_extracted')\n","\n","# Training ì›ì²œ ë°ì´í„° ê²½ë¡œ\n","train_origin_folder = os.path.join(base_path, '01.ë°ì´í„°/Training/ì›ì²œë°ì´í„°')\n","\n","# Validation ë¼ë²¨ë§ ë°ì´í„° ê²½ë¡œ\n","val_label_folder = os.path.join(base_path, '01.ë°ì´í„°/Validation/ë¼ë²¨ë§ë°ì´í„°')\n","\n","# Validation ì›ì²œ ë°ì´í„° ê²½ë¡œ\n","val_origin_folder = os.path.join(base_path, '01.ë°ì´í„°/Validation/ì›ì²œë°ì´í„°')\n","\n","# 5. Training - ë¼ë²¨ë§ë°ì´í„° ì••ì¶• í•´ì œ\n","os.makedirs(train_label_extract_folder, exist_ok=True)\n","unzip_file(os.path.join(train_label_folder, 'TL1_CAT.zip'), train_label_extract_folder)\n","unzip_file(os.path.join(train_label_folder, 'TL2_DOG.zip'), train_label_extract_folder)\n","\n","# 6. Training - ì›ì²œë°ì´í„° ì••ì¶• í•´ì œ\n","unzip_file(os.path.join(train_origin_folder, 'TS1_CAT.zip'), train_origin_folder)\n","unzip_file(os.path.join(train_origin_folder, 'TS2_DOG.zip'), train_origin_folder)\n","\n","# 7. Validation - ë¼ë²¨ë§ë°ì´í„° ì••ì¶• í•´ì œ\n","unzip_file(os.path.join(val_label_folder, 'VL1_CAT.zip'), val_label_folder)\n","unzip_file(os.path.join(val_label_folder, 'VL2_DOG.zip'), val_label_folder)\n","\n","# 8. Validation - ì›ì²œë°ì´í„° ì••ì¶• í•´ì œ\n","unzip_file(os.path.join(val_origin_folder, 'VS1_CAT.zip'), val_origin_folder)\n","unzip_file(os.path.join(val_origin_folder, 'VS2_DOG.zip'), val_origin_folder)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"collapsed":true,"id":"gum-P-PeC4bD","executionInfo":{"status":"aborted","timestamp":1745902142997,"user_tz":-540,"elapsed":214304,"user":{"displayName":"Seongyun Lee","userId":"17227422253819502349"}}},"outputs":[],"source":["# 1. í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ import\n","import os\n","import json\n","from PIL import Image\n","\n","# 2. ê¸°ë³¸ ê²½ë¡œ ì„¤ì •\n","base_path = '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)'\n","\n","# 3. ê²½ë¡œ ì„¸íŒ…\n","sets = {\n","    'train': {\n","        'json_folder': os.path.join(base_path, \"01.ë°ì´í„°/Training/ë¼ë²¨ë§ë°ì´í„°_extracted\"),  # â˜… ì••ì¶• í‘¼ ë¼ë²¨ ê²½ë¡œ ì£¼ì˜!\n","        'image_folder': os.path.join(base_path, \"01.ë°ì´í„°/Training/ì›ì²œë°ì´í„°\"),\n","        'output_folder': os.path.join(base_path, \"01.ë°ì´í„°/Training/labels\")\n","    },\n","    'val': {\n","        'json_folder': os.path.join(base_path, \"01.ë°ì´í„°/Validation/ë¼ë²¨ë§ë°ì´í„°\"),  # Validationì€ ë³„ë„ ì••ì¶• ì•ˆ í–ˆìœ¼ë©´ ì›ë˜ ê²½ë¡œ\n","        'image_folder': os.path.join(base_path, \"01.ë°ì´í„°/Validation/ì›ì²œë°ì´í„°\"),\n","        'output_folder': os.path.join(base_path, \"01.ë°ì´í„°/Validation/labels\")\n","    }\n","}\n","\n","# 4. ì§€ì›í•˜ëŠ” ì´ë¯¸ì§€ í™•ì¥ì\n","image_exts = ['.jpg', '.jpeg', '.png']\n","\n","# 5. ë³€í™˜ í•¨ìˆ˜ ì •ì˜\n","def convert_to_yolo(json_folder, image_folder, output_folder):\n","    os.makedirs(output_folder, exist_ok=True)\n","\n","    for file in os.listdir(json_folder):\n","        if file.endswith('.json'):\n","            base_name = os.path.splitext(file)[0]\n","            json_path = os.path.join(json_folder, file)\n","            print(f\"ğŸš§ í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ JSON íŒŒì¼: {json_path}\")  # ì¶”ê°€ëœ ì½”ë“œ\n","\n","            # JSON ë¡œë“œ\n","            try:\n","                with open(json_path, 'r', encoding='utf-8') as f:\n","                    data = json.load(f)\n","            except json.JSONDecodeError as e:\n","                print(f\"âŒ JSON ë””ì½”ë“œ ì—ëŸ¬ ë°œìƒ: {json_path} - {e}\")\n","                continue  # ì˜¤ë¥˜ ë°œìƒ ì‹œ ë‹¤ìŒ íŒŒì¼ë¡œ ê±´ë„ˆë›°ê¸°\n","\n","            # ì´ë¯¸ì§€ ì°¾ê¸°\n","            image_path = None\n","            for ext in image_exts:\n","                candidate = os.path.join(image_folder, base_name + ext)\n","                if os.path.exists(candidate):\n","                    image_path = candidate\n","                    break\n","\n","            if not image_path:\n","                print(f\"âš ï¸ ì´ë¯¸ì§€ ì—†ìŒ: {base_name}\")\n","                continue\n","\n","            # ì´ë¯¸ì§€ í¬ê¸° ì–»ê¸°\n","            with Image.open(image_path) as img:\n","                img_width, img_height = img.size\n","\n","            # YOLO í¬ë§· ë§Œë“¤ê¸°\n","            yolo_lines = []\n","            for ann in data.get(\"annotations\", []):\n","                if ann.get(\"shape\") == \"Bounding Box\":\n","                    (x1, y1), (x2, y2) = ann[\"points\"]\n","                    cx = (x1 + x2) / 2 / img_width\n","                    cy = (y1 + y2) / 2 / img_height\n","                    w = abs(x2 - x1) / img_width\n","                    h = abs(y2 - y1) / img_height\n","                    yolo_lines.append(f\"0 {cx:.6f} {cy:.6f} {w:.6f} {h:.6f}\")\n","\n","            # ì €ì¥\n","            out_path = os.path.join(output_folder, base_name + \".txt\")\n","            with open(out_path, \"w\", encoding='utf-8') as f:\n","                f.write(\"\\n\".join(yolo_lines))\n","\n","            print(f\"âœ… ë³€í™˜ ì™„ë£Œ: {base_name}.txt\")\n","\n","# 6. ë³€í™˜ ì‹¤í–‰\n","for phase, paths in sets.items():\n","    print(f\"\\nğŸ“‚ ì²˜ë¦¬ ì‹œì‘: {phase}\")\n","    convert_to_yolo(paths['json_folder'], paths['image_folder'], paths['output_folder'])\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wVJnguVhDNAc"},"outputs":[],"source":["# 1. train/val ì´ë¯¸ì§€ ê²½ë¡œ ì •ë¦¬\n","def make_dataset_txt(image_folder, save_txt_path):\n","    # ì§€ì›í•˜ëŠ” ì´ë¯¸ì§€ í™•ì¥ì\n","    image_exts = ['.jpg', '.jpeg', '.png']\n","\n","    img_paths = []\n","    for file in os.listdir(image_folder):\n","        if any(file.endswith(ext) for ext in image_exts):\n","            full_path = os.path.join(image_folder, file)\n","            img_paths.append(full_path)\n","\n","    img_paths.sort()  # (ì„ íƒ) ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ì •ë ¬\n","    print(f\"âœ… ì´ {len(img_paths)}ê°œ íŒŒì¼ ê¸°ë¡: {save_txt_path}\")\n","\n","    # txtë¡œ ì €ì¥\n","    with open(save_txt_path, 'w') as f:\n","        for path in img_paths:\n","            f.write(path + '\\n')\n","\n","# 2. ê²½ë¡œ ì„¤ì •\n","train_image_folder = '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)/01.ë°ì´í„°/Training/ì›ì²œë°ì´í„°'\n","val_image_folder = '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)/01.ë°ì´í„°/Validation/ì›ì²œë°ì´í„°'\n","\n","# ì €ì¥í•  txt ê²½ë¡œ\n","train_txt_path = '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)/train.txt'\n","val_txt_path = '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)/val.txt'\n","\n","# 3. ì‹¤í–‰\n","make_dataset_txt(train_image_folder, train_txt_path)\n","make_dataset_txt(val_image_folder, val_txt_path)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rwV-gykHDao3"},"outputs":[],"source":["import yaml\n","\n","# 1. YAML íŒŒì¼ì„ ìƒì„±í•  ë°ì´í„° ì„¤ì •\n","yaml_data = {\n","    'train': {\n","        'image_folder': train_image_folder,\n","        'label_folder': '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)/01.ë°ì´í„°/Training/labels',\n","        'dataset_txt': train_txt_path\n","    },\n","    'val': {\n","        'image_folder': val_image_folder,\n","        'label_folder': '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)/01.ë°ì´í„°/Validation/labels',\n","        'dataset_txt': val_txt_path\n","    }\n","}\n","\n","# 2. YAML íŒŒì¼ ê²½ë¡œ ì„¤ì •\n","yaml_file_path = '/content/drive/MyDrive/062.ë°˜ë ¤ë™ë¬¼ ì§ˆë³‘ ì§„ë‹¨ì„ ìœ„í•œ ì˜ìƒ ë°ì´í„° (ê·¼ê³¨ê²©ê³„)/dataset_config.yaml'\n","\n","# 3. YAML íŒŒì¼ ìƒì„±\n","with open(yaml_file_path, 'w') as yaml_file:\n","    yaml.dump(yaml_data, yaml_file, default_flow_style=False, allow_unicode=True)\n","\n","print(f\"âœ… YAML íŒŒì¼ ìƒì„± ì™„ë£Œ: {yaml_file_path}\")\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VAW1Y5W8EAuK"},"outputs":[],"source":["import cv2\n","import numpy as np\n","from matplotlib import pyplot as plt\n","\n","# 1. YOLO ëª¨ë¸ íŒŒì¼ ê²½ë¡œ\n","weights_path = '/path/to/yolov5/weights/file.pt'\n","config_path = '/path/to/yolov5/config/file.cfg'\n","class_names = ['class1', 'class2', 'class3']  # ë‹¤ì¹œ ë¶€ìœ„ë¥¼ í¬í•¨í•œ í´ë˜ìŠ¤ ì´ë¦„\n","\n","# 2. YOLO ëª¨ë¸ ë¡œë“œ (PyTorch ëª¨ë¸ ì˜ˆì‹œ)\n","import torch\n","\n","# YOLOv5 ëª¨ë¸ ë¡œë“œ (PyTorch Hub ì‚¬ìš©)\n","model = torch.hub.load('ultralytics/yolov5', 'custom', path=weights_path)\n","\n","# 3. ì´ë¯¸ì§€ ë¡œë“œ\n","image_path = '/path/to/image.jpg'\n","image = cv2.imread(image_path)\n","\n","# 4. YOLO ëª¨ë¸ë¡œ ì˜ˆì¸¡\n","results = model(image)\n","\n","# 5. ê²°ê³¼ì—ì„œ ë‹¤ì¹œ ë¶€ìœ„ (ì˜ˆ: 'injury' í´ë˜ìŠ¤)ë¥¼ ì°¾ê³  ì´ë¯¸ì§€ì— í‘œì‹œ\n","# ì˜ˆì‹œ: íŠ¹ì • í´ë˜ìŠ¤ IDë¡œ ê²°ê³¼ë¥¼ í•„í„°ë§\n","for result in results.xyxy[0]:  # ê²°ê³¼ì—ì„œ bounding box\n","    x1, y1, x2, y2, conf, cls = result[:6]\n","    label = class_names[int(cls)]\n","\n","    # ë‹¤ì¹œ ë¶€ìœ„ë¡œ ì¸ì‹ëœ ê²½ìš° (ì˜ˆ: 'injury' í´ë˜ìŠ¤)\n","    if label == 'injury':  # 'injury'ëŠ” ë‹¤ì¹œ ë¶€ìœ„ì— í•´ë‹¹í•˜ëŠ” í´ë˜ìŠ¤\n","        # Bounding box ê·¸ë¦¬ê¸°\n","        color = (255, 0, 0)  # ë¹¨ê°„ìƒ‰ ë°•ìŠ¤\n","        cv2.rectangle(image, (int(x1), int(y1)), (int(x2), int(y2)), color, 2)\n","        cv2.putText(image, label, (int(x1), int(y1)-10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, color, 2)\n","\n","# 6. ê²°ê³¼ ì´ë¯¸ì§€ ì¶œë ¥\n","plt.imshow(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))\n","plt.show()\n"]}],"metadata":{"accelerator":"GPU","colab":{"gpuType":"T4","provenance":[],"authorship_tag":"ABX9TyOt1Hu0r8VHFHcjyQd6stDa"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}